<div class="super-admin-dashboard">
  <div class="dashboard-header">
    <h1>
      <mat-icon>admin_panel_settings</mat-icon>
      {{ 'superAdmin.dashboard.title' | translate }}
    </h1>
    <button mat-raised-button color="primary" (click)="loadSystemStats()">
      <mat-icon>refresh</mat-icon>
      {{ 'superAdmin.dashboard.refresh' | translate }}
    </button>
  </div>

  <div class="loading-container" *ngIf="loading">
    <mat-spinner></mat-spinner>
    <p>{{ 'superAdmin.dashboard.loadingStats' | translate }}</p>
  </div>

  <div class="dashboard-content" *ngIf="!loading && systemStats">
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon primary">
            <mat-icon>business</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalOrganizations }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.organizations' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon accent">
            <mat-icon>people</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalUsers }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.totalUsers' | translate }}</p>
            <small>{{ systemStats.activeUsers }} {{ 'superAdmin.dashboard.statistics.active' | translate }}</small>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon warn">
            <mat-icon>personal_injury</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalPatients }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.patients' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon success">
            <mat-icon>medical_services</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalConsultations }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.consultations' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon info">
            <mat-icon>medication</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalPrescriptions }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.prescriptions' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card">
        <mat-card-content>
          <div class="stat-icon warning">
            <mat-icon>event</mat-icon>
          </div>
          <div class="stat-info">
            <h3>{{ systemStats.totalAppointments }}</h3>
            <p>{{ 'superAdmin.dashboard.statistics.appointments' | translate }}</p>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Charts Section -->
    <div class="charts-section">
      <!-- User Distribution by Role -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>{{ 'superAdmin.dashboard.charts.usersByRole' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="role-distribution">
            <div *ngFor="let role of roleChartData" class="role-item">
              <div class="role-bar-container">
                <div class="role-label">{{ role.name }}</div>
                <div class="role-bar">
                  <div class="role-bar-fill" 
                       [style.width.%]="(role.value / systemStats.totalUsers) * 100"
                       [attr.data-count]="role.value">
                  </div>
                </div>
                <div class="role-count">{{ role.value }}</div>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>

      <!-- Top Organizations -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>{{ 'superAdmin.dashboard.charts.topOrganizations' | translate }}</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="org-list">
            <div *ngFor="let org of systemStats.topOrganizations; let i = index" class="org-item">
              <div class="org-rank">#{{ i + 1 }}</div>
              <div class="org-info">
                <h4>{{ org.name }}</h4>
                <div class="org-stats">
                  <span class="stat-badge users">
                    <mat-icon>people</mat-icon>
                    {{ org.userCount }} {{ 'superAdmin.dashboard.charts.users' | translate }}
                  </span>
                  <span class="stat-badge patients">
                    <mat-icon>personal_injury</mat-icon>
                    {{ org.patientCount }} {{ 'superAdmin.dashboard.charts.patients' | translate }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Quick Actions -->
    <mat-card class="actions-card">
      <mat-card-header>
        <mat-card-title>{{ 'superAdmin.dashboard.quickActions.title' | translate }}</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="action-buttons">
          <button mat-raised-button routerLink="/super-admin/organizations">
            <mat-icon>business</mat-icon>
            {{ 'superAdmin.dashboard.quickActions.manageOrganizations' | translate }}
          </button>
          <button mat-raised-button routerLink="/super-admin/users">
            <mat-icon>people</mat-icon>
            {{ 'superAdmin.dashboard.quickActions.manageUsers' | translate }}
          </button>
          <button mat-raised-button routerLink="/super-admin/audit">
            <mat-icon>history</mat-icon>
            {{ 'superAdmin.dashboard.quickActions.viewAuditLogs' | translate }}
          </button>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>